<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="class_list.html"></iframe>

      <div id="content"><div id='filecontents'><p><img src="./ui/app/images/tenor_logo.png" height=150 /></p>

<p>TeNOR is the NFV Orchestrator platform developed by the <a href="http://www.t-nova.eu">T-NOVA</a> project, responsible for managing the entire NFV lifecycle service.</p>

<h2>Prerequisites</h2>

<ul>
<li>Ruby &gt;= 2.2.5 (installation provided in dependencies/install_dependencies.sh)</li>
<li>Bundler (installation provided in dependencies/install_dependencies.sh)</li>
<li>Gatekeeper (<a href="https://github.com/piyush82/auth-utils">https://github.com/piyush82/auth-utils</a>). (installation provided in dependencies/install_dependencies.sh)</li>
<li>MongoDB (installation provided in dependencies/install_dependencies.sh)</li>
<li>Openstack Juno version or higher</li>
</ul>

<h2>Optional Requirements</h2>

<ul>
<li>Service Mapping (<a href="https://github.com/T-NOVA/TeNOR/tree/master/service-mapper">https://github.com/T-NOVA/TeNOR/tree/master/service-mapper</a>). Used when more than 1 PoP is available.</li>
<li>Infrastructure Repository (<a href="https://github.com/T-NOVA/infrastructure-repository">https://github.com/T-NOVA/infrastructure-repository</a>). Used by the UI and the Service Mapping algorithm.</li>
<li>Middleware API (<a href="https://github.com/T-NOVA/mAPI">https://github.com/T-NOVA/mAPI</a>) (required for start/stop the Lifecycle events inside the VNFS)</li>
<li>VIM Monitoring (<a href="https://github.com/T-NOVA/vim-monitoring">https://github.com/T-NOVA/vim-monitoring</a>). Used for receive the monitoring from each VNF.</li>
<li>Netfloc (<a href="https://github.com/T-NOVA/netfloc">https://github.com/T-NOVA/netfloc</a>). Used for the VNFFG.</li>
<li>WICM (<a href="https://github.com/T-NOVA/WICM">https://github.com/T-NOVA/WICM</a>).</li>
<li>Apache Cassandra (optional, used for monitoring) (installation provided in dependencies/install_cassandra.sh)</li>
<li>Logstash (optional) &amp; ElasticSearch (optional)</li>
<li>RabbitMq (optional, used for monitoring) (installation provided in dependencies/install_dependencies.sh)</li>
</ul>

<h1>Getting started</h1>

<h2>Steps</h2>

<ol>
<li>Install the prerequisites (Ruby, Gatekeeper and MongoDB). The installation of these requirements is provided a script inside the <code>dependencies</code> folder. Use the <code>install_dependencies.sh</code> script if you want to install it automatically.</li>
<li>Install TeNOR (internal dependencies and configurations). Installation script provided in the root folder <code>tenor_install.sh</code>.</li>
<li>Start TeNOR.</li>
<li>Register the internal modules (automatic) and external modules (Mapping, mAPI, WICM, VIMMonitoring, Netfloc...).</li>
<li>Register a Network Function Virtualisation Infrastructure Point of Presence (NFVI-PoP) inserting the Openstack credentials into Gatekeeper.</li>
<li>Test deploying a sample NSD/VNFD to the inserted NFVI-PoP.</li>
</ol>

<h2>Installation</h2>

<p>We provide an installation script for Ubuntu 14.04 that helps with the installation of Ruby, Gatekeeper and MongoDB.</p>

<p>In order to install Ruby, the MongoDB and Gatekeeper execute the following script:</p>

<pre class="code ruby"><code class="ruby">./dependencies/install_dependencies.sh
</code></pre>

<p>For each requirement, the script will ask if you want to install it or not. Write <code>y</code> or <code>n</code> and press the Enter Key.</p>

<p>Once Ruby is installed (you can be sure of that using <code>ruby -v</code> command in the terminal), you can proceed with the TeNOR installation. In the root folder run the following script:</p>

<pre class="code ruby"><code class="ruby">./tenor_install.sh
</code></pre>

<p>A menu will appear and you can choose a number in the menu [1-7].</p>

<p>For TeNOR installation, insert the number 1 and press the Enter Key. The installation will start automatically installing the Ruby Gem dependencies. After few minutes, the script will ask you a set of questions regarding the location of the MongoDB, Gatekeeper and Logstash. In the case of insert an emty values, the script will use the default values (localhost).</p>

<p><strong>Make sure that you have installed a Ruby version &gt;= 2.2.5 and the <code>bundle</code> command is installed.</strong></p>

<p>Once the installation finishes, TeNOR needs to be <a href="#execution">started</a></p>

<h2>Vagrant (alternative installation)</h2>

<p>A Vagrantfile is provided with TeNOR, Gatekeeper and Mongodb installed.</p>

<h2>Docker (alternative installation)</h2>

<p>A Dockerfile is provided that generates a container with TeNOR, Gatekeeper and Mongodb installed. Once is running, all the components are installed and running.</p>

<ol>
<li><p>Build it with:</p>

<pre class="code ruby"><code class="ruby">docker build -t tnova/tenor .
</code></pre></li>
<li><p>Run the container with:</p>

<pre class="code ruby"><code class="ruby">docker run -itd -p 4000:4000 -p 8000:8000 -p 9000:9000 -v /opt/mongo:/var/lib/mongodb -v /opt/gatekeeper:/root/gatekeeper tnova/tenor bash
</code></pre></li>
<li><p>Then, you can test TeNOR (<a href="#test-if-tenor-is-installed-and-running">Test if TeNOR is installed and running</a>), and you can access to the command line with:</p>

<pre class="code ruby"><code class="ruby">docker exec -i -t $DOCKER_ID /bin/bash
</code></pre></li>
</ol>

<h2>Execution</h2>

<p>TeNOR can be executed in two ways:</p>

<ol>
<li><p>Using Invoker (<a href="http://invoker.codemancers.com">http://invoker.codemancers.com</a>) (<a href="#using-invoker">Help here</a>)</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_invoker'>invoker</span> <span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_invoker'>invoker</span><span class='period'>.</span><span class='id identifier rubyid_ini'>ini</span>
</code></pre></li>
<li><p>Using Byobu (modern Tmux). (sudo apt-get install byobu)  Useful for development purposes. (<a href="#using-byobu">Help here</a>)</p>

<pre class="code ruby"><code class="ruby">./tenor_development.sh
</code></pre></li>
</ol>

<p>How to test if TeNOR is installed <a href="#test-if-tenor-is-installed-and-running">Test if TeNOR is installed and running</a></p>

<h3>Using Invoker</h3>

<p>Invoker is an utility to manage all the processes in the environment. The basic commands are the following:</p>

<ul>
<li>invoker start invoker.ini -&gt; Start TeNOR.</li>
<li>invoker reload ns-manager -&gt; Restart the NS Manager service.</li>
<li>invoker list -&gt; Show the list of running microservices and the status.</li>
</ul>

<h3>Using Byobu</h3>

<p>Byobu is a modern Tmux that allows to execute multiple shells in one terminal. Typing the command <code>byobu</code> you will see a list of windows created using the provided script. More information of Byobu in (<a href="https://help.ubuntu.com/community/Byobu">https://help.ubuntu.com/community/Byobu</a>).</p>

<p>Basic keys for using Byobu:</p>

<ul>
<li>F3 and F4 for navigate through the windows</li>
<li>F6 exit from Byobu</li>
</ul>

<h2>Registering modules in TeNOR and Gatekeeper</h2>

<p>TeNOR has a microservice architecture and requires a registration of each microservices to the system. The NS Manager (API gateway) is the responsible to manage this registration. The internal TeNOR modules are managed automatically, but external modules like mAPI, WICM, Infrastructure repository and Netfloc needs to be registered.</p>

<p>The registration of modules can be done with in three ways:</p>

<ul>
<li>Using <a href="#user-interface">TeNOR User Interface</a>
<code>Configuration -&gt; Modules</code></li>
<li>Using the TeNOR script:
<code>./tenor_install.sh</code></li>
<li>Using the following script:
<code>./loadModules.sh</code></li>
</ul>

<p>The content of the loadModules.sh is a set of CuRL request to the NS Manager inserting the IP and PORT of each microservice. When the NS Manager recevies the requests, automatically register each module into Gatekeeper in order to generate a microservice-token.</p>

<h2>Loading NFVI-PoP information in Gatekeeper</h2>

<p>The PoP information is saved in Gatekeeper. This can be inserted in three manners:</p>

<ul>
<li>Using the TeNOR User Interface:
<code>Configuration -&gt; PoPs</code></li>
<li>Using the TeNOR script:
Execute the tenor_install.sh script and choose the option <code>4. Add new PoP</code></li>
<li>Using the CLI:</li>
</ul>

<p>First of all, define the following variables (you can copy and paste in the command prompt):</p>

<pre class="code ruby"><code class="ruby"> GATEKEEPER_HOST=localhost:8000
 GATEKEEPER_PASS=Eq7K8h9gpg
 GATEKEEPER_USER_ID=1
 OPENSTACK_IP=localhost
 admin_tenant_name=tenantName
 keystonePass=password
 keystoneUser=admin
 openstack_dns=8.8.8.8
</code></pre>

<p>Get the Gatekeeper token (you can copy and paste in the command prompt):</p>

<pre class="code ruby"><code class="ruby">tokenId=$(curl -XPOST http://$GATEKEEPER_HOST/token/ -H &quot;X-Auth-Password:$GATEKEEPER_PASS&quot; -H &quot;X-Auth-Uid:$GATEKEEPER_USER_ID&quot; | python -c &#39;import json,sys;obj=json.load(sys.stdin);print obj[&quot;token&quot;][&quot;id&quot;]&#39;)
</code></pre>

<p>Post PoP Information (you can copy and paste in the command prompt):</p>

<pre class="code ruby"><code class="ruby"> curl -X POST http://$GATEKEEPER_HOST/admin/dc/ \
   -H &#39;X-Auth-Token: &#39;$tokenId&#39;&#39; \
   -d &#39;{&quot;msg&quot;: &quot;PoP Testbed&quot;, &quot;dcname&quot;:&quot;default&quot;, &quot;adminid&quot;:&quot;&#39;$keystoneUser&#39;&quot;,&quot;password&quot;:&quot;&#39;$keystonePass&#39;&quot;, &quot;extrainfo&quot;:&quot;pop-ip=&#39;$OPENSTACK_IP&#39; tenant-name=&#39;$admin_tenant_name&#39; keystone-endpoint=http://&#39;$OPENSTACK_IP&#39;:35357/v2.0 orch-endpoint=http://&#39;$OPENSTACK_IP&#39;:8004/v1 compute-endpoint=http://&#39;$OPENSTACK_IP&#39;:8774/v2.1 neutron-endpoint=http://&#39;$OPENSTACK_IP&#39;:9696/v2.0 dns=&#39;$openstack_dns&#39;&quot;}&#39;
</code></pre>

<h2>User Interface</h2>

<p>TeNOR has a User Interface that provides a global view of the all the orchestration functionalities. Allows to read the descriptors, instantiate services, see the monitoring data and configure TeNOR.</p>

<p>This user interface is located in the <code>ui</code> folder and contains their own README file with the installation guide.</p>

<h1>Initial steps</h1>

<h2>Test if TeNOR is installed and running</h2>

<p>Make a request to the following address (NS Manager):</p>

<pre class="code ruby"><code class="ruby">curl -XGET http://localhost:4000/
</code></pre>

<p>If nothing is received, make sure that the NS Manager is running.
If you receive a response, means that the NS Manager is ready for recevie requests.</p>

<p>In order to see the available IPs for the NS Manager, visit the API Documentation (<a href="http://t-nova.github.io/TeNOR/">http://t-nova.github.io/TeNOR/</a>)</p>

<h2>Define a VNFD and a NSD</h2>

<p>Once TeNOR is ready to use, you should define a VNF Descriptor and a NS Descriptor. This task has some complexity and this repository contains a dummy descriptors that can be deployed without modification. You can find it in the NSD and VNFD validator modules.</p>

<p>The dummy NSD is located in:
<code>nsd-validator/assets/samples/nsd_example.json</code></p>

<p>The dummy VNFD is located in:
<code>vnfd-validator/assets/samples/vnfd_example.json</code></p>

<p>The next step is add the dummy descriptors to TeNOR system using the API. This step is explained in the following subsection.</p>

<h2>Create a VNFD and NSD and instantiate it</h2>

<p>In order to test TeNOR functionality, you can deploy a dummy NSD/VNFD located in the Validator folders. Follow the next steps in order to test TeNOR (you can copy and paste in the command prompt):</p>

<ol>
<li><p>Add the VNFD in the VNF catalogue</p>

<pre class="code ruby"><code class="ruby">curl -XPOST localhost:4000/vnfs -H &quot;Content-Type: application/json&quot; --data-binary @vnfd-validator/assets/samples/vnfd_example.json
</code></pre></li>
<li><p>Add the NSD in the NS catalogue</p>

<pre class="code ruby"><code class="ruby">curl -XPOST localhost:4000/network-services -H &quot;Content-Type: application/json&quot; --data-binary @nsd-validator/assets/samples/nsd_example.json
</code></pre></li>
<li><p>Get the NSD ID (identification) from the NS Catalogue (getting the first NSD, so if more NSDs are defined, this command needs to be modified accordingly)</p>

<pre class="code ruby"><code class="ruby">ns_id=$(curl -XGET localhost:4000/network-services | python -c &#39;import json,sys;obj=json.load(sys.stdin);print obj[0][&quot;nsd&quot;][&quot;id&quot;]&#39;)
</code></pre></li>
<li><p>Instantiate the NSD using the NSD ID extracted from the catalogue</p>

<pre class="code ruby"><code class="ruby">curl -XPOST localhost:4000/ns-instances -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;ns_id&quot;: &quot;&#39;$ns_id&#39;&quot;, &quot;callbackUrl&quot;: &quot;https://httpbin.org/post&quot;, &quot;flavour&quot;: &quot;basic&quot;}&#39;
</code></pre></li>
</ol>

<h2>Write a Lifecycle events</h2>

<p>In each VNFD can have 5 types of lifecycle event: start, stop, restart, scaling_out and scaling_in. For each type, some data can be requested, but basically, the different template is in the scaling actions.</p>

<ul>
<li>Get PublicIp of port in a VDU: get_attr[vdu0,CP5v7d,PublicIp]</li>
<li>Get PrivateIp of port in a VDU: get_attr[CPr3k7,fixed_ips,0,ip_address]</li>
<li>Get the last VDU for scaling-out: get_attr[vdu1,vdus]</li>
<li>Get the last PrivateIps for scaling-out: gig-adaet_attr[CPsx4l,fixed_ips,0,ip_address]</li>
<li>Get the last PublicIps for scaling-out: get_attr[vdu0,CPudhr,PublicIp]</li>
<li>Timeout before remove instance due scale-in event:</li>
</ul>

<h1>Development</h1>

<h2>Microservice ports</h2>

<p>Each microservice is listening in different port. This port is configured in the <code>config.yml</code> file of each module (folder).</p>

<table><thead>
<tr>
<th>Microservice</th>
<th>Port</th>
</tr>
</thead><tbody>
<tr>
<td>NS Manager</td>
<td>4000</td>
</tr>
<tr>
<td>NS Catalogue</td>
<td>4011</td>
</tr>
<tr>
<td>NS Provisioner</td>
<td>4012</td>
</tr>
<tr>
<td>NS Monitoring</td>
<td>4013</td>
</tr>
<tr>
<td>NSD Validator</td>
<td>4015</td>
</tr>
<tr>
<td>VNF Manager</td>
<td>4567</td>
</tr>
<tr>
<td>VNF Catalogue</td>
<td>4568</td>
</tr>
<tr>
<td>VNFD Validator</td>
<td>4570</td>
</tr>
<tr>
<td>HOT Generator</td>
<td>4571</td>
</tr>
<tr>
<td>VNF Catalogue</td>
<td>4572</td>
</tr>
<tr>
<td>VNF Monitoring</td>
<td>4573</td>
</tr>
</tbody></table>

<h1>License</h1>

<p>Each module is published under different licenses, please take a look on each License file.</p>
</div></div>

      <div id="footer">
  Generated on Mon Oct 10 16:31:09 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.0).
</div>

    </div>
  </body>
</html>